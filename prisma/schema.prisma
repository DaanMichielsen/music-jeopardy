generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Game {
  id          String   @id @default(cuid())
  title       String
  question    String
  maxPlayers  Int      @default(4)
  status      GameStatus @default(WAITING)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  createdBy   String?
  
  players     GamePlayer[]
  results     GameResult[]
  
  @@map("games")
}

model GamePlayer {
  id       String @id @default(cuid())
  gameId   String
  name     String
  joinedAt DateTime @default(now())
  
  game     Game @relation(fields: [gameId], references: [id], onDelete: Cascade)
  results  GameResult[]
  
  @@unique([gameId, name])
  @@map("game_players")
}

model GameResult {
  id       String @id @default(cuid())
  gameId   String
  playerId String
  score    Int
  position Int
  isWinner Boolean @default(false)
  createdAt DateTime @default(now())
  
  game     Game @relation(fields: [gameId], references: [id], onDelete: Cascade)
  player   GamePlayer @relation(fields: [playerId], references: [id], onDelete: Cascade)
  
  @@map("game_results")
}

enum GameStatus {
  WAITING
  IN_PROGRESS
  COMPLETED
  CANCELLED
}
